# 2 URL과 리소스

- URL 문법, 여러 URL 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서
- URL의 인코딩과 문자 규칙
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능하게 해주는 URN(Uniform Resource Name)을 포함된 URL의 미래

## 2.1 인터넷의 리소스 탐색하기

대부분의 URL 형식: `스킴://서버위치//경로`

http://www.joes-hardware.com/seasonal/index-fall.html 이라는 URL을 살펴보면

- `http`는 URL의 **스킴**이다. 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려준다. 이 경우에, URL이 HTTP 프로토콜을 사용한다.
- `www.joes-hardware.com`은 **서버의 위치**다. 이는 웹 클라이언트가 리소스가 어디에 호스팅되어 있는지 알려준다.
- `/seasonal/index-fall.html`은 **리소스의 경로**다. 서버에 존재하는 로콜 리소스들 중에서 요청받은 리소스가 무엇인지 알려준다.

### 2.1.1 URL이 있기 전 암흑의 시대

웹과 URL이 있기 전에 사람들은 네트워크 상에 산재해 있는 데이터에 접근하기 위해서, 오합지졸에 가까울 정도로 애플리케이션마다 달리 가지고 있는 분류 방식을 사용했다.

## 2.2 URL 문법

`<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>`

일반적인 URL 컴포넌트들

컴포넌트|설명|기본값
-|-|-
스킴|리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는지 가리킨다|없음
사용자 이름|며쳧 스킴은 리소스에 접근을 하기 위해 사용자 이름을 필요로 한다|anonymous
비밀번호|사용자의 비밀번호를 가리키며, 사용자 이름에 콜론(:)으로 이어서 기술한다|<이메일 주소>
호스트|리소스를 호스팅하는 서버의 호스트 명이나 IP 주소|없음
포트|리소스를 호스팅하는 서버가 열어 놓은 포트번호. 많은 스킴이 기본 포트를 가지고 있다(HTTP의 기본 포트는 80이다)|스킴에 따라 다름
경로|이전 컴포넌트와 빗금(/)으로 구분되어 있으며, 서버내 리로스가 서버 어디에 있는지를 가리킨다. 경로 컴포넌트의 문법은 서버와 스킴에 따라 다르다. (URL의 경로를 세그먼트로 나눌 수 있고, 각 세그먼트는 자체 컴포넌트를 가질 수 있다)|없음
파라미터|특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용한다. 파라미터는 이름/값을 쌍으로 가진다. 파라미터는, 다른 파라미터나 경로의 일부와 세미콜론(;)으로 구분하여 기술하며, 여러 개를 가질 수 있다.
질의|스킴에서 애플리케이션(데이터베이스, 게시판, 검색엔진, 기타 인터넷 게이트웨이)에 파라미터를 전달하는데 쓰인다. 질의 컴포넌트를 작성하는데 쓰이는 공통 포맷은 없다. 이는 URL의 끝에 "?"로 구분한다.|없음
프래그먼트|리소스의 조각이나 일부분을 가리키는 이름이다. URL이 특정 객체를 가리킬 경우에 프래그먼트 필드는 서버에 전달되지 않는다. 이는 클라이언트에서만 사용한다. URL의 끝에서 "#"문자로 구분한다.|없음

### 2.2.1 스킴: 사용할 프로토콜

스킴 컴포넌트은 URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려준다. 알파벳으로 시작해야하고, 구분자는 ":"이고, 대소문자를 가리지 않는다.

### 2.2.2 호스트와 포트

호스트 컴포넌트는 리소스를 호스팅하고 있는 장비가 어디에 있는지를 알려주고, 포트 컴포넌트는 그 장비내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 알려준다. 호스트 컴포넌트는 호스트명(ex. www.joes-hardware.com)이나 IP 주소로 제공한다. 포트 컴포넌트는 서버가 열어 놓은 네트워크 포트를 가리킨다.

### 2.2.3 사용자 이름과 비밀번호

많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다.

ex. FTP 서버

```url
ftp://ftp.prep.ai.mid.edu/pub/gnu
```

위의 예시에서는 사용자 이름이나 비밀번호가 없기 때문에 기본 사용자 이름("anonymous")과 비밀번호 값(브라우저마다 다름)을 집어 넣는다.

```url
ftp://anonymous@ftp.prep.ai.mid.edu/pub/gnu
```

비밀번호 컴포넌트가 생략된 형태이다

```url
ftp://anonymous:my_password@ftp.prep.ai.mid.edu/pub/gnu
```

사용자 이름 컴포넌트와 비밀번호 컴포넌트가 ":" 문자로 분리되어 모두 기술되었다.

### 2.2.4 경로

경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다. 경로 컴포넌트는 경로조각으로 나눌 수 있다.

```url
http://www.joes-hardware.com/hammer/index.html
```

경로 컴포넌트 `hammer/index.html`은 두개의 경로조각 `hammer`와 `index.html`로 나눌 수 있다.

### 2.2.5 파라미터

애플리케이션이 리소스에 접근하는데 필요한 추가 정보를 전달하는데 쓰인다. 경로 컴포넌트의 각 경로조각은 자체 파라미터를 가질 수 있다.

```url
http://www.joes-hardware.com/hammer;sale=false/index.html;graphics=true
```

hammer 경로조각은 값이 false인 sale라는 파라미터를 가지고, index.html 경로 조각은 값이 true인 graphics란 파라미터를 가진다.

### 2.2.6 질의 문자열

데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다. 사용하면 안되는 특정 문자들을 제외하고 질의 컴포넌트 포맷에 제약사항은 없다.

```url
http://www.joes-hardware.com/inventory-check.cgi?item=12731&color=blue
```

위의 예에서는 이름/값 쌍으로 된 두 개의 질의 컴포넌트가 존재한다. item=12731과 color=blue. (편의상 많은 게이트웨이가 "&"로 나뉜 "이름=값" 형식의 질의 문자열을 요구한다.)

### 2.2.7 프래그먼트

프래그먼트 컴포넌트는 리소스의 특정 부분(ex. 절, paragraph)을 가리킨다. 일반적으로 HTTP 서버는 객체 일부가 아닌 전체만 다루기 때문에, 클라이언트는 서버에 프래그먼트를 전달하지 않고, 브라우저가 서버로부터 전체 리소스를 내려받은 후, 프래그먼트 컴포넌트를 사용하여 사용자가 보고자 하는 리소스의 일부를 보여준다.

## 2.3 단축 URL

### 2.3.1 상대 URL

기저(base)라는 다른 URL을 사용하여, URL을 짧게 표기하는 방식이다.

```text
http://www.joes-hardware.com/tools.htmml

./hammer.html

http://www.joes-hardware.com/hammer.html
```

위의 예시에서 기저 URL은 `http://www.joes-hardware.com` 이고 상대 URL은 `./hammer.html`이며 새로운 절대 URL은 `http://www.joes-hardware.com/hammer.html`이다.

URL을 처리하는 브라우저같은 애플리케이션은 상대 URL과 절대 URL을 상호 변환할 수 있어야 한다.

### 2.3.2 URL 확장

어떤 브라우저는 URL을 입력한 다음이나 입력하고있는 동안에 자동으로 URL을 확장한다. 이런 "확장" 기능은 두가지로 나뉜다.

#### 호스트명 확장

단순 휴리스틱만을 사용해서 입력한 호스트명을 전체 호스트명으로 바꿔준다. 예를들면 'yahoo'를 입력하면 'www.yahoo.com'으로 바꾸어준다. 사용자의 시간을 줄여주는 장점이 있지만, 프락시와 같은 다른 HTTP 애플리케이션에 문제를 발생시킬 수도 있다.

#### 히스토리 확장

과거에 사용자가 방문했던 URL의 기록을 저장하여, 이전에 방문했던 URL의 시작부분을 입력하면 완결된 형태의 URL을 선택할 수 있도록 보여준다. 이 역시 프락시를 사용할 경우 다르게 동작할 수 있다.

## 2.4 안전하지 않은 문자

URL은 상대적으로 작고 일반적으로 안전한 이진데이터나 알파벳 문자만 포함하도록 허락한다. 그리고 사람들이 이진 데이터나 알파벳 외의 문자를 포함하려고 할때를 위해 이스케이프 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였다.

### 2.4.1 URL 문자 집합

US-ASCII 문자 집합을 사용한다. 오래된 문자 집합이기 때문에 타 언어나 특정 이진 데이터를 URL에서 지원하기 위해 이스케이프 문자열도 포함한다.

### 2.4.2 인코딩 체계

인코딩은 안전하지 않은 문자를 "%"로 시작해, ASCII 코드로 표현되는 두개의 16진수 숫자로 이루어진 "이스케이프" 문자로 바꾼다.

문자|ASCII|URL의 예
-|-|-
~|126(0x7E)|http://www.joes-hardware.com/%7Ejoe
빈 문자|32(0x20)|http://www.joes-hardware.com/more%29tools.html
%|37(0x25)|http://www.joes-hardware.com/100%25satisfaction.html
